# è®¾ç½®ç®¡ç†å‘˜é‚®ç®±æŒ‡å—

## ç›®æ ‡
ç¡®ä¿é‚®ç®± `12310203@mail.sustech.edu.cn` åœ¨æµ‹è¯•ç¯å¢ƒå¯ç”¨ä¸”ä¸ºç®¡ç†å‘˜ã€‚

## å¿«é€Ÿæ‰§è¡Œï¼ˆæ¨èï¼‰

### æ–¹å¼1: åœ¨æœåŠ¡å™¨ä¸Šç›´æ¥è¿è¡Œ

```bash
# SSH ç™»å½•æœåŠ¡å™¨
ssh root@ieclub.online

# è¿›å…¥æµ‹è¯•ç¯å¢ƒé¡¹ç›®ç›®å½•
cd /root/IEclub_dev_staging/ieclub-backend

# è¿è¡Œè®¾ç½®è„šæœ¬
bash scripts/setup-admin-email-remote.sh
```

### æ–¹å¼2: æ‰‹åŠ¨æ‰§è¡Œæ­¥éª¤

```bash
# 1. SSH ç™»å½•æœåŠ¡å™¨
ssh root@ieclub.online

# 2. è¿›å…¥æµ‹è¯•ç¯å¢ƒé¡¹ç›®ç›®å½•
cd /root/IEclub_dev_staging/ieclub-backend

# 3. æ£€æŸ¥å¹¶è¿è¡Œæ•°æ®åº“è¿ç§»ï¼ˆå¦‚æœéœ€è¦ï¼‰
npx prisma db push

# 4. è¿è¡Œè®¾ç½®è„šæœ¬
node scripts/setup-admin-email.js
```

## è„šæœ¬åŠŸèƒ½

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œï¼š

1. âœ… **æ£€æŸ¥æ•°æ®åº“è¿æ¥** - ç¡®ä¿å¯ä»¥è¿æ¥åˆ°æ•°æ®åº“
2. âœ… **æ£€æŸ¥ EmailWhitelist è¡¨** - ç¡®ä¿è¡¨å­˜åœ¨ï¼ˆå¦‚æœä¸å­˜åœ¨ä¼šæç¤ºè¿è¡Œè¿ç§»ï¼‰
3. âœ… **æ£€æŸ¥ç®¡ç†å‘˜çŠ¶æ€** - æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²ç»æ˜¯ç®¡ç†å‘˜
4. âœ… **åˆ›å»º/æ›´æ–°ç®¡ç†å‘˜** - å¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå¦‚æœå­˜åœ¨åˆ™ç¡®ä¿æ˜¯è¶…çº§ç®¡ç†å‘˜
5. âœ… **æ£€æŸ¥ç”¨æˆ·è´¦å·** - æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²æ³¨å†Œä¸ºç”¨æˆ·
6. âœ… **æ£€æŸ¥ç™½åå•çŠ¶æ€** - ç¡®è®¤å­¦æ ¡é‚®ç®±ä¸éœ€è¦ç™½åå•

## é¢„æœŸç»“æœ

æ‰§è¡ŒæˆåŠŸåï¼Œæ‚¨å°†çœ‹åˆ°ï¼š

```
âœ… è®¾ç½®å®Œæˆï¼

ğŸ“‹ æ€»ç»“:
   âœ… é‚®ç®± 12310203@mail.sustech.edu.cn å·²è®¾ç½®ä¸ºè¶…çº§ç®¡ç†å‘˜
   âœ… å¯ä»¥åœ¨æµ‹è¯•ç¯å¢ƒä½¿ç”¨è¯¥é‚®ç®±ç™»å½•ç®¡ç†åå°
   âœ… å­¦æ ¡é‚®ç®±å¯ä»¥ç›´æ¥æ³¨å†Œï¼Œæ— éœ€ç™½åå•

ğŸ”— ç™»å½•ä¿¡æ¯:
   ç®¡ç†åå°: https://test.ieclub.online/admin
   é‚®ç®±: 12310203@mail.sustech.edu.cn
   é»˜è®¤å¯†ç : Admin@123456 (å¦‚æœæ˜¯æ–°åˆ›å»º)
   âš ï¸  è¯·å°½å¿«ç™»å½•å¹¶ä¿®æ”¹å¯†ç ï¼
```

## éªŒè¯

è®¾ç½®å®Œæˆåï¼Œè¯·éªŒè¯ï¼š

1. **ç™»å½•ç®¡ç†åå°**
   - è®¿é—®: https://test.ieclub.online/admin
   - ä½¿ç”¨é‚®ç®± `12310203@mail.sustech.edu.cn` ç™»å½•
   - å¦‚æœæç¤ºå¯†ç é”™è¯¯ï¼Œä½¿ç”¨é»˜è®¤å¯†ç  `Admin@123456`

2. **æ£€æŸ¥ç®¡ç†å‘˜æƒé™**
   - ç™»å½•ååº”è¯¥å¯ä»¥çœ‹åˆ°æ‰€æœ‰ç®¡ç†åŠŸèƒ½
   - è§’è‰²åº”è¯¥æ˜¯"è¶…çº§ç®¡ç†å‘˜"

3. **æµ‹è¯•ç”¨æˆ·æ³¨å†Œ**ï¼ˆå¦‚æœéœ€è¦ï¼‰
   - è®¿é—®: https://test.ieclub.online
   - ä½¿ç”¨é‚®ç®± `12310203@mail.sustech.edu.cn` æ³¨å†Œ
   - å­¦æ ¡é‚®ç®±åº”è¯¥å¯ä»¥ç›´æ¥æ³¨å†Œï¼Œæ— éœ€ç™½åå•

## æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ•°æ®åº“è¿æ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯**: `Can't reach database server at ...`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥æ•°æ®åº“æœåŠ¡æ˜¯å¦è¿è¡Œ
systemctl status mysql

# æ£€æŸ¥ç¯å¢ƒå˜é‡
cat .env.staging | grep DATABASE_URL

# æµ‹è¯•æ•°æ®åº“è¿æ¥
mysql -h [host] -u [user] -p [database]
```

### é—®é¢˜2: EmailWhitelist è¡¨ä¸å­˜åœ¨

**é”™è¯¯ä¿¡æ¯**: `Table 'email_whitelist' does not exist`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# è¿è¡Œæ•°æ®åº“è¿ç§»
npx prisma db push

# æˆ–ä½¿ç”¨è¿ç§»
npx prisma migrate deploy
```

### é—®é¢˜3: ç®¡ç†å‘˜åˆ›å»ºå¤±è´¥

**é”™è¯¯ä¿¡æ¯**: `é‚®ç®±å·²å­˜åœ¨` æˆ–å…¶ä»–é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ç°æœ‰ç®¡ç†å‘˜
node scripts/manage-admin.js list

# å¦‚æœé‚®ç®±å·²å­˜åœ¨ä½†ä¸æ˜¯ç®¡ç†å‘˜ï¼Œæ‰‹åŠ¨æ·»åŠ 
node scripts/manage-admin.js add
# ç„¶åè¾“å…¥é‚®ç®±å’Œå¯†ç 

# å¦‚æœé‚®ç®±å·²å­˜åœ¨ä½†è§’è‰²ä¸å¯¹ï¼Œä¿®æ”¹è§’è‰²
node scripts/manage-admin.js change-role 12310203@mail.sustech.edu.cn super_admin
```

## æ³¨æ„äº‹é¡¹

1. âš ï¸ **é»˜è®¤å¯†ç **: å¦‚æœæ˜¯æ–°åˆ›å»ºçš„ç®¡ç†å‘˜ï¼Œé»˜è®¤å¯†ç æ˜¯ `Admin@123456`ï¼Œè¯·å°½å¿«ä¿®æ”¹
2. âš ï¸ **ç¯å¢ƒé…ç½®**: ç¡®ä¿ä½¿ç”¨æµ‹è¯•ç¯å¢ƒçš„é…ç½®æ–‡ä»¶ `.env.staging`
3. âš ï¸ **æ•°æ®åº“å¤‡ä»½**: åœ¨ç”Ÿäº§ç¯å¢ƒæ“ä½œå‰ï¼Œå»ºè®®å…ˆå¤‡ä»½æ•°æ®åº“
4. âœ… **å­¦æ ¡é‚®ç®±**: å­¦æ ¡é‚®ç®±ï¼ˆmail.sustech.edu.cnï¼‰åœ¨æµ‹è¯•ç¯å¢ƒå¯ä»¥ç›´æ¥æ³¨å†Œï¼Œæ— éœ€ç™½åå•

## ç›¸å…³è„šæœ¬

- `scripts/setup-admin-email.js` - ä¸»è®¾ç½®è„šæœ¬
- `scripts/setup-admin-email-remote.sh` - æœåŠ¡å™¨ç«¯ä¸€é”®æ‰§è¡Œè„šæœ¬
- `scripts/manage-admin.js` - ç®¡ç†å‘˜ç®¡ç†è„šæœ¬
- `scripts/manage-email-whitelist.js` - é‚®ç®±ç™½åå•ç®¡ç†è„šæœ¬

