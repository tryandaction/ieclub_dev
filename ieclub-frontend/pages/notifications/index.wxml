<!--pages/notifications/index.wxml-->
<view class="notifications-page">
  <!-- é¡¶éƒ¨ç­›é€‰ -->
  <view class="filter-bar">
    <view class="filter-tabs">
      <view 
        class="tab-item {{filter === 'all' ? 'active' : ''}}"
        bindtap="changeFilter"
        data-filter="all"
      >
        <text>å…¨éƒ¨</text>
      </view>
      <view 
        class="tab-item {{filter === 'unread' ? 'active' : ''}}"
        bindtap="changeFilter"
        data-filter="unread"
      >
        <text>æœªè¯»</text>
      </view>
    </view>
    <view class="mark-all-btn" bindtap="markAllAsRead">
      <text>å…¨éƒ¨å·²è¯»</text>
    </view>
  </view>

  <!-- é€šçŸ¥åˆ—è¡¨ -->
  <view class="notification-list" wx:if="{{notifications.length > 0}}">
    <view 
      class="notification-item {{item.isRead ? 'read' : ''}}"
      wx:for="{{notifications}}"
      wx:key="id"
      bindtap="handleNotificationTap"
      data-id="{{item.id}}"
      data-link="{{item.link}}"
      data-is-read="{{item.isRead}}"
    >
      <!-- æœªè¯»æ ‡è®° -->
      <view class="unread-dot" wx:if="{{!item.isRead}}"></view>
      
      <!-- å›¾æ ‡ -->
      <view class="icon-wrapper" style="background: {{typeConfig[item.type].color || '#6b7280'}}20">
        <text class="icon">{{typeConfig[item.type].icon || 'ðŸ””'}}</text>
      </view>
      
      <!-- å†…å®¹ -->
      <view class="content-wrapper">
        <view class="title">{{item.title}}</view>
        <view class="content">{{item.content}}</view>
        <view class="time">{{item.createdAt}}</view>
      </view>
      
      <!-- ç®­å¤´ -->
      <view class="arrow" wx:if="{{item.link}}">
        <text>â€º</text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && notifications.length === 0}}">
    <view class="empty-icon">ðŸ””</view>
    <view class="empty-text">æš‚æ— {{filter === 'unread' ? 'æœªè¯»' : ''}}é€šçŸ¥</view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{!loading && hasMore && notifications.length > 0}}">
    <text>ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
  </view>

  <!-- æ²¡æœ‰æ›´å¤š -->
  <view class="no-more" wx:if="{{!loading && !hasMore && notifications.length > 0}}">
    <text>æ²¡æœ‰æ›´å¤šäº†</text>
  </view>
</view>
