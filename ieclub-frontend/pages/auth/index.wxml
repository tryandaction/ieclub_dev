<!--pages/auth/index.wxml-->
<view class="auth-page">
  <!-- é¡¶éƒ¨è¿”å›æŒ‰é’® -->
  <view class="nav-bar">
    <view class="nav-back" bindtap="goBack">
      <text class="back-icon">â†</text>
      <text class="back-text">è¿”å›</text>
    </view>
  </view>

  <!-- ä¸»å†…å®¹åŒº -->
  <view class="content">
    <!-- æ ‡é¢˜åŒºåŸŸ -->
    <view class="header">
      <text class="title">{{isRegister ? 'æ³¨å†Œè´¦å·' : 'é‚®ç®±ç™»å½•'}}</text>
      <text class="subtitle">{{isRegister ? 'åˆ›å»ºæ‚¨çš„IEClubè´¦å·' : 'ä½¿ç”¨å—ç§‘å¤§é‚®ç®±ç™»å½•'}}</text>
    </view>

    <!-- è¡¨å• -->
    <view class="form">
      <!-- é‚®ç®± -->
      <view class="form-item">
        <view class="label">
          <text class="icon">ğŸ“§</text>
          <text>é‚®ç®±åœ°å€</text>
        </view>
        <input 
          class="input {{emailError ? 'error' : ''}}" 
          type="text"
          placeholder="è¯·è¾“å…¥å­¦æ ¡é‚®ç®±"
          value="{{email}}"
          bindinput="onEmailInput"
          bindblur="onEmailInput"
        />
        <text wx:if="{{emailError}}" class="error-tip">{{emailError}}</text>
      </view>

      <!-- å¯†ç ï¼ˆç™»å½•å¯†ç æ¨¡å¼ï¼‰ -->
      <view class="form-item" wx:if="{{!isRegister && !useCode}}">
        <view class="label">
          <text class="icon">ğŸ”’</text>
          <text>å¯†ç </text>
        </view>
        <input 
          class="input {{passwordError ? 'error' : ''}}" 
          type="password"
          placeholder="è¯·è¾“å…¥å¯†ç "
          value="{{password}}"
          bindinput="onPasswordInput"
        />
        <text wx:if="{{passwordError}}" class="error-tip">{{passwordError}}</text>
      </view>

      <!-- éªŒè¯ç  -->
      <view class="form-item" wx:if="{{useCode || isRegister}}">
        <view class="label">
          <text class="icon">ğŸ”‘</text>
          <text>éªŒè¯ç </text>
        </view>
        <view class="code-input-wrapper">
          <input 
            class="input code-input {{codeError ? 'error' : ''}}" 
            type="number"
            maxlength="6"
            placeholder="è¯·è¾“å…¥6ä½éªŒè¯ç "
            value="{{code}}"
            bindinput="onCodeInput"
          />
          <button 
            class="code-btn {{countdown > 0 ? 'disabled' : ''}}" 
            bindtap="sendCode"
            disabled="{{countdown > 0}}"
          >
            {{countdown > 0 ? countdown + 's' : 'è·å–éªŒè¯ç '}}
          </button>
        </view>
        <text wx:if="{{codeError}}" class="error-tip">{{codeError}}</text>
      </view>

      <!-- å¯†ç ï¼ˆæ³¨å†Œæ—¶ï¼‰ -->
      <view class="form-item" wx:if="{{isRegister}}">
        <view class="label">
          <text class="icon">ğŸ”’</text>
          <text>è®¾ç½®å¯†ç </text>
        </view>
        <input 
          class="input {{passwordError ? 'error' : ''}}" 
          type="password"
          placeholder="è‡³å°‘8ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—"
          value="{{password}}"
          bindinput="onPasswordInput"
        />
        <view class="password-tip">
          <text class="tip-text">å¯†ç è¦æ±‚ï¼šè‡³å°‘8ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—</text>
        </view>
        <text wx:if="{{passwordError}}" class="error-tip">{{passwordError}}</text>
      </view>

      <!-- ç™»å½•æ–¹å¼åˆ‡æ¢ï¼ˆä»…ç™»å½•æ—¶ï¼‰ -->
      <view class="switch-line" wx:if="{{!isRegister}}">
        <text class="link" bindtap="toggleCodeLogin">
          {{useCode ? 'å¯†ç ç™»å½•' : 'éªŒè¯ç ç™»å½•'}}
        </text>
      </view>

      <!-- æäº¤æŒ‰é’® -->
      <button 
        class="submit-btn {{loading ? 'loading' : ''}}" 
        bindtap="handleSubmit"
        disabled="{{loading}}"
      >
        {{loading ? (isRegister ? 'æ³¨å†Œä¸­...' : 'ç™»å½•ä¸­...') : (isRegister ? 'ç«‹å³æ³¨å†Œ' : 'ç™»å½•')}}
      </button>

      <!-- åº•éƒ¨åˆ‡æ¢ -->
      <view class="footer">
        <text class="footer-text">{{isRegister ? 'å·²æœ‰è´¦å·ï¼Ÿ' : 'è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ'}}</text>
        <text class="footer-link" bindtap="toggleMode">
          {{isRegister ? 'å»ç™»å½•' : 'ç«‹å³æ³¨å†Œ'}}
        </text>
      </view>
    </view>
  </view>
</view>
