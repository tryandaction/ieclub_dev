<!--pages/my-topics/index.wxml-->
<view class="my-topics-page">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <view class="header-content">
      <view class="header-title">
        <text class="title-icon">ğŸ“</text>
        <text class="title-text">æˆ‘çš„è¯é¢˜</text>
      </view>
      <view class="header-stats">
        <view class="stat-item">
          <text class="stat-value">{{stats.total}}</text>
          <text class="stat-label">è¯é¢˜</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-value">{{stats.totalLikes}}</text>
          <text class="stat-label">ç‚¹èµ</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-value">{{stats.totalComments}}</text>
          <text class="stat-label">è¯„è®º</text>
        </view>
      </view>
    </view>
  </view>

  <!-- è¯é¢˜åˆ—è¡¨ -->
  <view class="topics-container">
    <!-- åŠ è½½ä¸­éª¨æ¶å± -->
    <view wx:if="{{loading && topics.length === 0}}" class="skeleton-list">
      <view class="skeleton-item" wx:for="{{[1,2,3]}}" wx:key="*this">
        <view class="skeleton-header">
          <view class="skeleton-title"></view>
          <view class="skeleton-time"></view>
        </view>
        <view class="skeleton-content"></view>
        <view class="skeleton-footer">
          <view class="skeleton-tag"></view>
          <view class="skeleton-tag"></view>
        </view>
      </view>
    </view>

    <!-- è¯é¢˜åˆ—è¡¨ -->
    <view wx:if="{{!isEmpty && topics.length > 0}}" class="topic-list">
      <view 
        class="topic-card"
        wx:for="{{topics}}"
        wx:key="id"
        bindtap="goToTopicDetail"
        data-id="{{item.id}}"
        hover-class="topic-card-hover"
      >
        <!-- è¯é¢˜å¤´éƒ¨ -->
        <view class="topic-header">
          <view class="topic-category">
            <text class="category-icon">{{item.category === 'demand' ? 'ğŸ”' : item.category === 'supply' ? 'ğŸ’¡' : 'ğŸ“¢'}}</text>
            <text class="category-text">
              {{item.category === 'demand' ? 'éœ€æ±‚' : item.category === 'supply' ? 'ä¾›ç»™' : 'æ™®é€š'}}
            </text>
          </view>
          <text class="topic-time">{{item.createdAt}}</text>
        </view>

        <!-- è¯é¢˜æ ‡é¢˜ -->
        <view class="topic-title">{{item.title}}</view>

        <!-- è¯é¢˜å†…å®¹ -->
        <view class="topic-content">{{item.content}}</view>

        <!-- è¯é¢˜æ ‡ç­¾ -->
        <view wx:if="{{item.tags && item.tags.length > 0}}" class="topic-tags">
          <view class="tag-item" wx:for="{{item.tags}}" wx:for-item="tag" wx:key="*this">
            #{{tag}}
          </view>
        </view>

        <!-- è¯é¢˜åº•éƒ¨æ•°æ® -->
        <view class="topic-footer">
          <view class="footer-stats">
            <view class="stat-badge">
              <text class="stat-icon">ğŸ‘</text>
              <text class="stat-count">{{item._count.likes || 0}}</text>
            </view>
            <view class="stat-badge">
              <text class="stat-icon">ğŸ’¬</text>
              <text class="stat-count">{{item._count.comments || 0}}</text>
            </view>
            <view class="stat-badge">
              <text class="stat-icon">â­</text>
              <text class="stat-count">{{item._count.bookmarks || 0}}</text>
            </view>
          </view>
          
          <view class="topic-status {{item.status}}">
            <text>{{item.status === 'published' ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿'}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{isEmpty && !loading}}" class="empty-state">
      <text class="empty-icon">ğŸ“­</text>
      <text class="empty-title">è¿˜æ²¡æœ‰å‘å¸ƒè¯é¢˜</text>
      <text class="empty-desc">å¿«å»å‘å¸ƒä½ çš„ç¬¬ä¸€ä¸ªè¯é¢˜å§</text>
      <button class="empty-btn" bindtap="goToPublish">
        <text class="btn-icon">âœï¸</text>
        <text>å‘å¸ƒè¯é¢˜</text>
      </button>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view wx:if="{{topics.length > 0}}" class="load-more">
      <view wx:if="{{loading}}" class="loading-text">
        <text class="loading-icon">â³</text>
        <text>åŠ è½½ä¸­...</text>
      </view>
      <view wx:elif="{{!hasMore}}" class="no-more-text">
        <text class="divider-line"></text>
        <text class="no-more-label">æ²¡æœ‰æ›´å¤šäº†</text>
        <text class="divider-line"></text>
      </view>
    </view>
  </view>

  <!-- æµ®åŠ¨å‘å¸ƒæŒ‰é’® -->
  <view class="fab-button" bindtap="goToPublish" hover-class="fab-button-hover">
    <text class="fab-icon">âœš</text>
  </view>
</view>
