"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[653],{8514:function(e,s,a){var n=a(7842),r=a(5006),c=a(3949),l=a(6784),t=a(8140),i=a(118),o=a(8833),u=a(758),h=a.n(u),d=a(9231),m=a(4416),f=a(5349);function p(e){var s=e.topic,a=e.onClick;return(0,f.jsxs)(i.Ss,{className:"topic-card",onClick:a,children:[(0,f.jsxs)(i.Ss,{className:"card-header",children:[(0,f.jsx)(i._V,{className:"avatar",src:s.author.avatar,mode:"aspectFill"}),(0,f.jsxs)(i.Ss,{className:"author-info",children:[(0,f.jsx)(i.EY,{className:"nickname",children:s.author.nickname}),(0,f.jsx)(i.EY,{className:"time",children:(0,m.fw)(s.createdAt)})]})]}),(0,f.jsxs)(i.Ss,{className:"card-content",children:[(0,f.jsx)(i.EY,{className:"title",children:s.title}),(0,f.jsx)(i.EY,{className:"content",children:s.content})]}),s.images&&s.images.length>0&&(0,f.jsx)(i.Ss,{className:"card-images",children:s.images.slice(0,3).map(function(e,s){return(0,f.jsx)(i._V,{className:"image-item",src:e,mode:"aspectFill"},s)})}),s.tags&&s.tags.length>0&&(0,f.jsx)(i.Ss,{className:"card-tags",children:s.tags.slice(0,3).map(function(e){return(0,f.jsxs)(i.Ss,{className:"tag",children:["#",e]},e)})}),(0,f.jsxs)(i.Ss,{className:"card-footer",children:[(0,f.jsxs)(i.Ss,{className:"stat-item",children:[(0,f.jsx)(i.EY,{className:"icon",children:"\ud83d\udc41"}),(0,f.jsx)(i.EY,{className:"value",children:s.viewsCount})]}),(0,f.jsxs)(i.Ss,{className:"stat-item",children:[(0,f.jsx)(i.EY,{className:"icon",children:"\u2764\ufe0f"}),(0,f.jsx)(i.EY,{className:"value",children:s.likesCount})]}),(0,f.jsxs)(i.Ss,{className:"stat-item",children:[(0,f.jsx)(i.EY,{className:"icon",children:"\ud83d\udcac"}),(0,f.jsx)(i.EY,{className:"value",children:s.commentsCount})]})]})]})}function x(e){e.filters;var s=e.onChange,a=[{label:"\u6700\u65b0",value:"latest"},{label:"\u6700\u70ed",value:"hot"},{label:"\u7cbe\u534e",value:"featured"}],n=[{label:"\u5168\u90e8",value:""},{label:"\u6280\u672f",value:"tech"},{label:"\u79d1\u5b66",value:"science"},{label:"\u751f\u6d3b",value:"life"},{label:"\u5b66\u4e60",value:"study"},{label:"\u5176\u4ed6",value:"other"}],r=(0,o.useState)(0),c=(0,t.A)(r,2),l=c[0],u=c[1],h=(0,o.useState)(0),d=(0,t.A)(h,2),m=d[0],p=d[1],x=function(e){var n=e.detail.value;u(n),s({sortBy:a[n].value})},v=function(e){var a=e.detail.value;p(a),s({category:n[a].value||void 0})};return(0,f.jsxs)(i.Ss,{className:"topic-filters",children:[(0,f.jsx)(i.LC,{mode:"selector",range:a.map(function(e){return e.label}),value:l,onChange:x,children:(0,f.jsxs)(i.Ss,{className:"filter-item",children:[(0,f.jsx)(i.Ss,{className:"filter-label",children:a[l].label}),(0,f.jsx)(i.Ss,{className:"filter-arrow",children:"\u25bc"})]})}),(0,f.jsx)(i.LC,{mode:"selector",range:n.map(function(e){return e.label}),value:m,onChange:v,children:(0,f.jsxs)(i.Ss,{className:"filter-item",children:[(0,f.jsx)(i.Ss,{className:"filter-label",children:n[m].label}),(0,f.jsx)(i.Ss,{className:"filter-arrow",children:"\u25bc"})]})})]})}var v=a(8179),j=a(6330);function g(){var e=(0,d.e)(),s=e.topics,a=e.hasMore,n=e.loading,u=e.filters,m=e.fetchTopics,g=e.setFilters,N=e.clearTopics,S=(0,o.useState)(!1),b=(0,t.A)(S,2),w=b[0],A=b[1];(0,o.useEffect)(function(){var e=function(){var e=(0,l.A)((0,c.A)().m(function e(){var s;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,m({page:1});case 1:e.n=3;break;case 2:e.p=2,s=e.v,console.error("\u52a0\u8f7d\u8bdd\u9898\u5931\u8d25:",s);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}();return e(),function(){N()}},[m,N]);var C=function(){var e=(0,l.A)((0,c.A)().m(function e(){return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return A(!0),e.p=1,e.n=2,m({page:1});case 2:return e.p=2,A(!1),e.f(2);case 3:return e.a(2)}},e,null,[[1,,2,3]])}));return function(){return e.apply(this,arguments)}}(),k=function(){var e=(0,l.A)((0,c.A)().m(function e(){var s;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(a&&!n){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,m({page:u.page+1},!0);case 2:e.n=4;break;case 3:e.p=3,s=e.v,console.error("\u52a0\u8f7d\u66f4\u591a\u5931\u8d25:",s);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,l.A)((0,c.A)().m(function e(s){return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:return g((0,r.A)((0,r.A)({},s),{},{page:1})),e.n=1,m((0,r.A)((0,r.A)({},s),{},{page:1}));case 1:return e.a(2)}},e)}));return function(s){return e.apply(this,arguments)}}(),Y=function(){h().navigateTo({url:"/pages/create-topic/index"})},T=function(e){h().navigateTo({url:"/pages/topic-detail/index?id=".concat(e)})};return(0,f.jsxs)(i.Ss,{className:"topics-page",children:[(0,f.jsx)(x,{filters:u,onChange:E}),(0,f.jsx)(i.BM,{className:"topics-scroll",scrollY:!0,refresherEnabled:!0,refresherTriggered:w,onRefresherRefresh:C,onScrollToLower:k,lowerThreshold:100,children:n&&0===s.length?(0,f.jsx)(j.A,{}):0===s.length?(0,f.jsx)(v.A,{title:"\u6682\u65e0\u8bdd\u9898",description:"\u5feb\u6765\u53d1\u5e03\u7b2c\u4e00\u4e2a\u8bdd\u9898\u5427",actionText:"\u53d1\u5e03\u8bdd\u9898",onAction:Y}):(0,f.jsxs)(i.Ss,{className:"topics-list",children:[s.map(function(e){return(0,f.jsx)(p,{topic:e,onClick:function(){return T(e.id)}},e.id)}),a&&(0,f.jsx)(i.Ss,{className:"load-more",children:n?"\u52a0\u8f7d\u4e2d...":"\u4e0a\u62c9\u52a0\u8f7d\u66f4\u591a"}),!a&&s.length>0&&(0,f.jsx)(i.Ss,{className:"no-more",children:"\u6ca1\u6709\u66f4\u591a\u4e86"})]})}),(0,f.jsx)(i.Ss,{className:"create-btn",onClick:Y,children:(0,f.jsx)(i.Ss,{className:"create-icon",children:"+"})})]})}var N={navigationBarTitleText:"\u8bdd\u9898\u5e7f\u573a",enablePullDownRefresh:!1,backgroundColor:"#f5f5f5"};Page((0,n.createPageConfig)(g,"pages/topics/index",{root:{cn:[]}},N||{}))}},function(e){var s=function(s){return e(e.s=s)};e.O(0,[907,96,76],function(){return s(8514)});e.O()}]);